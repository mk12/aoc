# Copyright 2022 Mitchell Kember. Subject to the MIT License.
# Advent of Code 2022
# Day 5: Supply Stacks

âŸ¨Cut, Lines, N, SplitâŸ© â† â€¢Import "common.bqn"

âŸ¨init, stepsâŸ© â† âŸ¨
  (âˆ¨`' 'âŠ¸â‰ )âŠ¸/Â¨Â·<Ë˜Â·((1=4|âŠ¢)âŠ¸/â†•âˆ˜â‰ )âŠ¸âŠÂ·â‰Â¯1â†“>
  -âŸœ0â€¿1â€¿1Ë˜Â·>(NÂ¨(<âŸœ'0'âˆ¨>âŸœ'9')Â¨âŠ¸Cut)Â¨
âŸ©{ğ•ğ•©}Â¨(0=â‰ )Â¨âŠ¸Split Lines "2022_05"

# Executes step ğ•¨ on state ğ•©, applying ğ”½ on moved crates.
_ex â† {
  âŸ¨n, src, dstâŸ© â† ğ•¨
  ((nâ†“âŠ£) â‹ˆ âŠ¢âˆ¾ËœÂ·ğ”½nâ†‘âŠ£)Â´âŒ¾(srcâ€¿dstâŠ¸âŠ)ğ•©
}

# Simulates all steps, applying ğ• on moved crates.
S â† {âŠ‘Â¨ init ğ•_exË âŒ½steps}

# Part 1
â€¢Out S{âŒ½}

# Part 2
â€¢Out S{âŠ¢}
